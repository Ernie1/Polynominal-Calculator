<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>README</title>
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0}body{font-family:Helvetica,arial,freesans,clean,sans-serif;font-size:14px;line-height:1.6;color:#333;background-color:#fff;padding:20px;max-width:960px;margin:0 auto}body>*:first-child{margin-top:0 !important}body>*:last-child{margin-bottom:0 !important}p,blockquote,ul,ol,dl,table,pre{margin:15px 0}h1,h2,h3,h4,h5,h6{margin:20px 0 10px;padding:0;font-weight:bold;-webkit-font-smoothing:antialiased}h1 tt,h1 code,h2 tt,h2 code,h3 tt,h3 code,h4 tt,h4 code,h5 tt,h5 code,h6 tt,h6 code{font-size:inherit}h1{font-size:28px;color:#000}h2{font-size:24px;border-bottom:1px solid #ccc;color:#000}h3{font-size:18px}h4{font-size:16px}h5{font-size:14px}h6{color:#777;font-size:14px}body>h2:first-child,body>h1:first-child,body>h1:first-child+h2,body>h3:first-child,body>h4:first-child,body>h5:first-child,body>h6:first-child{margin-top:0;padding-top:0}a:first-child h1,a:first-child h2,a:first-child h3,a:first-child h4,a:first-child h5,a:first-child h6{margin-top:0;padding-top:0}h1+p,h2+p,h3+p,h4+p,h5+p,h6+p{margin-top:10px}a{color:#4183c4;text-decoration:none}a:hover{text-decoration:underline}ul,ol{padding-left:30px}ul li>:first-child,ol li>:first-child,ul li ul:first-of-type,ol li ol:first-of-type,ul li ol:first-of-type,ol li ul:first-of-type{margin-top:0}ul ul,ul ol,ol ol,ol ul{margin-bottom:0}dl{padding:0}dl dt{font-size:14px;font-weight:bold;font-style:italic;padding:0;margin:15px 0 5px}dl dt:first-child{padding:0}dl dt>:first-child{margin-top:0}dl dt>:last-child{margin-bottom:0}dl dd{margin:0 0 15px;padding:0 15px}dl dd>:first-child{margin-top:0}dl dd>:last-child{margin-bottom:0}pre,code,tt{font-size:12px;font-family:Consolas,"Liberation Mono",Courier,monospace}code,tt{margin:0;padding:0;white-space:nowrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px}pre>code{margin:0;padding:0;white-space:pre;border:0;background:transparent}pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre code,pre tt{background-color:transparent;border:0}blockquote{border-left:4px solid #DDD;padding:0 15px;color:#777}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}hr{clear:both;margin:15px 0;height:0;overflow:hidden;border:0;background:transparent;border-bottom:4px solid #ddd;padding:0}table th{font-weight:bold}table th,table td{border:1px solid #ccc;padding:6px 13px}table tr{border-top:1px solid #ccc;background-color:#fff}table tr:nth-child(2n){background-color:#f8f8f8}img{max-width:100%}
</style>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="y2t1" id="readme">README</h1><p data-anchor-id="4n3l"><div class="toc"><div class="toc">
<ul>
<li><a href="#环境">环境</a></li>
<li><a href="#功能">功能</a></li>
<li><a href="#关于库的使用">关于库的使用</a></li>
<li><a href="#异常处理">异常处理</a></li>
<li><a href="#技术">技术</a></li>
<li><a href="#v2更新">V2更新</a></li>
<li><a href="#随时返回主菜单">随时返回主菜单</a><ul>
<li><a href="#基本思路">基本思路</a></li>
<li><a href="#细节">细节</a></li>
<li><a href="#缺陷">缺陷</a></li>
</ul>
</li>
<li><a href="#结语">结语</a></li>
</ul>
</li>
</ul>
</div>
</div>
</p><div class="md-section-divider"></div><h2 data-anchor-id="wful" id="环境">环境</h2><ol data-anchor-id="7ktq">
<li>Windows 10 + Visual Studio 2017 Cummunity;</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="j43z" id="功能">功能</h2><ol data-anchor-id="xg0h">
<li>商品名称检查, 商品名称可带空格;</li>
<li>具备文件存取功能;</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="rzxm" id="关于库的使用">关于库的使用</h2><ol data-anchor-id="wukg">
<li>基础功能并未使用WINDOWS的库;</li>
<li>用户操作的<code>_getch()</code>使用<code>conio.h</code>;</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="5jer" id="异常处理">异常处理</h2><ol data-anchor-id="y7eb">
<li>读取输入不允许输入空格;</li>
<li>多项式只能输入100组以内的数对, 且必须按<code>(float,int)</code>输入<code>(+1.0,+1)(-0.1,-1)(.1,1)</code>合法, <code>(-.1,-1)(+.1,1)(1.1.1,1)(1.0,0.1)(a,b)</code>不合法;</li>
<li>多项式命名只能包含字母数字;</li>
<li>菜单选择异常自动重来;</li>
<li>文件简易检查;</li>
<li>多项式名称限定10位以内;</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="g5lv" id="技术">技术</h2><ol data-anchor-id="7dwx">
<li>类封装;</li>
<li>单例模式;</li>
<li>map集合;</li>
<li>记录自动存档;</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="he4i" id="v2更新">V2更新</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="5r2c"><ol class="linenums"><li class="L0"><code><span class="com">//C风格</span></code></li><li class="L1"><code><span class="kwd">const</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="kwd">in</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> input</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">();</span></code></li><li class="L2"><code><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> count</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">int</span><span class="pln"> exp</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">float</span><span class="pln"> coef</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">    sscanf_s</span><span class="pun">(</span><span class="kwd">in</span><span class="pun">,</span><span class="pln"> </span><span class="str">"%*c%f%*c%d%*c"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">coef</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">exp</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">    addTerm</span><span class="pun">(</span><span class="pln">exp</span><span class="pun">,</span><span class="pln"> coef</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pun">}</span></code></li><li class="L8"><code><span class="com">//C++风格</span></code></li><li class="L9"><code><span class="pln">stringstream </span><span class="kwd">in</span><span class="pun">(</span><span class="pln">input</span><span class="pun">);</span></code></li><li class="L0"><code><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> count</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">int</span><span class="pln"> exp</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">float</span><span class="pln"> coef</span><span class="pun">;</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">char</span><span class="pln"> ch</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> ch </span><span class="pun">&gt;&gt;</span><span class="pln"> coef </span><span class="pun">&gt;&gt;</span><span class="pln"> ch </span><span class="pun">&gt;&gt;</span><span class="pln"> exp </span><span class="pun">&gt;&gt;</span><span class="pln"> ch</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">    addTerm</span><span class="pun">(</span><span class="pln">exp</span><span class="pun">,</span><span class="pln"> coef</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pun">}</span></code></li></ol></pre><ol data-anchor-id="2z1x">
<li>多项式读取的正则表达式;</li>
<li>多项式名称限定10位以内;</li>
<li>等号对齐显示储存多项式;</li>
<li>优化代码<code>add(),sub(),mul(),jug()</code>换成<code>operate('+'),operate('-'),operate('*'),operate('=')</code></li>
<li>在操作上方显示记录, 方便操作;</li>
<li>为Display Record加入Delete a Polynominal子功能;</li>
<li>菜单界面改为不回显输入;</li>
<li>彩蛋: 菜单界面按A键显示版权信息;</li>
<li>改善直接Enter空输入的情形;</li>
<li>修复了保存结果多项式输入名字时有空格引起不良反应的BUG;</li>
<li>新增Esc键可全局使用以返回主菜单;</li>
<li>主菜单用<code>getch()</code>提示错误指令对双字节键的优化, 避免一闪而过</li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ec27"><ol class="linenums"><li class="L0"><code><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0x00</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0xE0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\nError Dictate!"</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">    _getch</span><span class="pun">();</span></code></li><li class="L3"><code><span class="pln">    _getch</span><span class="pun">();</span></code></li><li class="L4"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="kn61" id="随时返回主菜单">随时返回主菜单</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="9fmp"><ol class="linenums"><li class="L0"><code><span class="kwd">bool</span><span class="pln"> inputEsc</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">    </span><span class="kwd">int</span><span class="pln"> ch</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">        ch </span><span class="pun">=</span><span class="pln"> _getch</span><span class="pun">();</span></code></li><li class="L4"><code><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0x00</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0XE0</span><span class="pun">)</span><span class="pln">   </span><span class="com">//if extended key</span></code></li><li class="L5"><code><span class="pln">            _getch</span><span class="pun">();</span><span class="pln">   </span><span class="com">//gets scan code</span></code></li><li class="L6"><code><span class="pln">        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="lit">27</span><span class="pun">)</span></code></li><li class="L7"><code><span class="pln">            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></code></li><li class="L8"><code><span class="pln">        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">.</span><span class="pln">length</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code><span class="pln">            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\b \b"</span><span class="pun">;</span><span class="pln">    </span><span class="com">// backspace, 光标回退一格</span></code></li><li class="L0"><code><span class="pln">            </span><span class="kwd">get</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">.</span><span class="pln">substr</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">.</span><span class="pln">length</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L1"><code><span class="pln">        </span><span class="pun">}</span></code></li><li class="L2"><code><span class="pln">        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'\r'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">get</span><span class="pun">.</span><span class="pln">length</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L5"><code><span class="pln">                </span><span class="kwd">continue</span><span class="pun">;</span></code></li><li class="L6"><code><span class="pln">            </span><span class="kwd">else</span></code></li><li class="L7"><code><span class="pln">                </span><span class="kwd">break</span><span class="pun">;</span></code></li><li class="L8"><code><span class="pln">        </span><span class="pun">}</span></code></li><li class="L9"><code><span class="pln">        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">126</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">    </span><span class="com">//可打印字符</span></code></li><li class="L0"><code><span class="pln">            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="kwd">static_cast</span><span class="str">&lt;char&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch</span><span class="pun">);</span></code></li><li class="L1"><code><span class="pln">            </span><span class="kwd">get</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> ch</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">        </span><span class="pun">}</span></code></li><li class="L3"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="cyw2" id="基本思路">基本思路</h3><ol data-anchor-id="33m9">
<li>采用<code>conio.h</code>的非缓冲输入<code>getch()</code>函数 (VS为<code>_getch()</code>), 可打印的实时打印并记录到string上,  Backspace光标左移打印空格再光标左移, 模拟缓冲输入效果, Esc返回非, Enter结束输入, 其他忽略;</li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="kij0" id="细节">细节</h3><ol data-anchor-id="bcbj">
<li>键盘一些控制键如上下左右键的键值是双字节的, 而getch()只能读取单字节, 读取扩展字符必须进行两次调用, 第一次返回该键的扩展的字符(0xE0 或 0x00), 第二个调用返回的实际的键代码;</li>
<li>一开始误用char ch, ch=getch(), 这样无法判断0xE0 或 0x00, 应用int ch;</li>
<li>对于Backspace, 应判断string的长度是否不是0, 若不判断, 将导致界面越界回退;</li>
<li>对于Enter, 应判断string的长度是否是0, 若不判断, 将导致输入可能为空;</li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="cdbx" id="缺陷">缺陷</h3><ol data-anchor-id="b0ni">
<li>输入时无法通过Ctrl+V粘贴数据, 但可通过快速编辑的右键粘贴;</li>
<li>输入时左右键失效, 但影响不大;</li>
</ol><div class="md-section-divider"></div><h2 data-anchor-id="qm2g" id="结语">结语</h2><ol data-anchor-id="3wga">
<li>自我感觉健壮性不错(逃)</li>
</ol></div>
</body>
</html>